@model U5ProgWebPartituras.Models.ViewModels.DetallesViewModel
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalles: Sonata K. 545 - Repositorio</title>
    <link rel="stylesheet" href="~/scripts/Styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        .badge-expert {
            background-color: darkred;
            color: white;
        }
    </style>
</head>
<body>

    <header class="navbar">
        <div class="logo">
            <i class="fas fa-file-alt"></i>
            Repositorio de Partituras
        </div>
        <nav class="nav-links">
            <a href="@Url.Action("Index", "Home")" class="nav-link active"><i class="fas fa-home"></i> Inicio</a>
            <a href="@Url.Action("Index", "Home", new { area = "Admin" })" class="nav-link"><i class="fas fa-user-shield"></i> Administración</a>
        </nav>
    </header>
    @{
        string extension = Model.ExtensionPartitura.ToLowerInvariant();
        string archivoPartitura = $"/partituras/{Model.Id}.{extension}";
        string archivoAudio = $"/audios/{Model.Id}.wav";
    }

    <main class="content-page">

        <div class="score-detail-container">

            <section class="score-viewer">

                <h2 class="viewer-title"><i class="fas fa-eye"></i> Previsualización de Partitura</h2>

                <div class="viewer-frame-wrapper">
                    @if (extension == "pdf")
                    {
                        <iframe src="@archivoPartitura"
                                title="Partitura @Model.Titulo"
                                width="100%" height="100%" frameborder="0"
                                allowfullscreen>
                        </iframe>
                    }
                    else if (extension == "jpg" || extension == "jpeg" || extension == "png")
                    {
                        <img src="@archivoPartitura"
                             alt="Partitura - @Model.Titulo"
                             class="partitura-image" />
                    }
                    else
                    {
                        <img src="https://placehold.co/800x600/CCCCCC/333333?text=Archivo+no+disponible"
                             alt="Archivo no disponible"
                             class="partitura-image" style="width:100%; align-content:flex-start"/>
                    }
                </div>

            </section>

            <aside class="score-info-panel">
                <h1 class="detail-title">@Model.Titulo</h1>

                <div class="metadata-group">
                    <p class="metadata-item"><i class="fas fa-user"></i> Compositor: <strong>@Model.Compositor</strong></p>
                    <p class="metadata-item"><i class="fas fa-music"></i> Género: <span class="tag tag-clásico">@Model.GeneroMusical</span></p><!--diselo cambiar-->
                    @{
                        string claseBadge = "";
                        switch (Model.Dificultad)
                        {
                            case "Principiante": claseBadge = "badge"; break;
                            case "Fácil": claseBadge = "badge-light-medium"; break;
                            case "Intermedio": claseBadge = "badge-medium"; break;
                            case "Avanzado": claseBadge = "badge-advanced"; break;
                            case "Experto": claseBadge = "badge-expert"; break;
                        }
                    }
                    <p class="metadata-item"><i class="fas fa-tachometer-alt"></i> Nivel: <span class="badge @claseBadge">@Model.Dificultad</span></p><!--diseño cambiar-->
                    <p class="metadata-item"><i class="fas fa-calendar-alt"></i> Instrumentación: @Model.Instrumentacion</p>
                    <p class="metadata-item"><i class="fas fa-file-pdf"></i> Formato: (@(extension == "" ? "Archivo no disponible" : extension.ToUpper()))</p>
                </div>
                @if (!string.IsNullOrEmpty(Model.Id.ToString()))
                {
                    <div class="audio-player-box">
                        <h3><i class="fas fa-headphones"></i> Escuchar Fragmento</h3>
                        <audio controls style="width: 100%;">
                            <source src="@archivoAudio" type="audio/mpeg">
                            Tu navegador no soporta el elemento de audio.
                        </audio>
                    </div>
                }
                @* <div class="score-list-item">
                    <h3><i class="fas fa-download"></i> Descargar Archivos</h3>
                    <div class="score-actions">
                        <a href="@archivoPartitura" class="btn-details list-btn download-btn" download>
                            <i class="fas fa-file-pdf"></i> Descargar Partitura (@extension.ToUpper())
                        </a>

                        @if (!string.IsNullOrEmpty(Model.Id.ToString()))
                        {
                            <a href="@archivoAudio" class="btn-details list-btn download-btn" download>
                                <i class="fas fa-file-audio"></i> Descargar Audio (MP3)
                            </a>
                        }
                    </div>
                </div> *@
                <div class="description-box">
                    <h3>Descripción</h3>
                    <p>@(Model.Descripcion)</p>
                </div>


            </aside>

        </div>
    </main>

</body>
</html>